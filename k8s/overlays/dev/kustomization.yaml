apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: jretirewise

bases:
- ../../base

# Override replicas for dev
replicas:
- name: jretirewise-celery
  count: 1
- name: jretirewise-web
  count: 1

# ConfigMap overrides for development
configMapGenerator:
- name: jretirewise-config
  behavior: merge
  literals:
  - DEBUG=true
  - ALLOWED_HOSTS=localhost,127.0.0.1,dev.jretirewise.local
  - SECURE_SSL_REDIRECT=false
  - SESSION_COOKIE_SECURE=false
  - CSRF_COOKIE_SECURE=false
  - EMAIL_BACKEND=django.core.mail.backends.console.EmailBackend

# Image replacement for dev (local builds)
images:
- name: jretirewise
  newName: jretirewise
  newTag: dev

commonLabels:
  environment: development

namePrefix: dev-

patchesStrategicMerge:
- deployment-web-patch.yaml
- statefulset-postgres-patch.yaml
- deployment-redis-patch.yaml

commonAnnotations:
  environment: development
  kustomize.config.k8s.io/version: "5.0.0"
